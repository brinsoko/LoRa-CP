{# app/templates/teams_list.html #}
{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Teams</h2>
    {% if has_role('judge','admin') %}
      <a class="btn btn-primary" href="{{ url_for('teams.add_team') }}">Add Team</a>
    {% endif %}
  </div>

  <div class="text-muted mb-2">Total: {{ teams|length }}</div>

  {% if teams|length == 0 %}
    <div class="alert alert-info">No teams found.</div>
  {% else %}
    <table class="table table-striped align-middle">
  <thead>
    <tr>
      <th>Name</th>
      <th>Number</th>
      <th>Groups</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for team in teams %}
      <tr>
        <td>{{ team.name }}</td>
        <td>{{ team.number or "â€”" }}</td>

        <td>
          {% if team.group_assignments %}
            {% for tg in team.group_assignments %}
              {% if tg.group %}
                <span class="badge {% if tg.active %}bg-success{% else %}bg-secondary{% endif %}">
                  {{ tg.group.name }}
                </span>
              {% endif %}
            {% endfor %}
          {% else %}
            <span class="text-muted">No groups</span>
          {% endif %}
        </td>

        <td>
          <a href="{{ url_for('teams.edit_team', team_id=team.id) }}" class="btn btn-sm btn-outline-primary">Edit</a>
          <form action="{{ url_for('teams.delete_team', team_id=team.id) }}" method="post" class="d-inline">
            <button type="submit" class="btn btn-sm btn-outline-danger"
                    onclick="return confirm('Delete this team?')">Delete</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
  {% endif %}
</div>
{% endblock %}

